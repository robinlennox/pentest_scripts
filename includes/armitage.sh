#!/bin/bash

# Armitage SVN #
PACKAGE_NAME="Armitage"
PRINT_MESSAGE "Checking for ${PACKAGE_NAME} updates"
#Local Variables
SVNLOCATION="http://armitage.googlecode.com/svn/trunk/release/armitage-unix"
REMOTEVERSION=$(svn info ${SVNLOCATION} | grep Revision | cut -f 2 -d:)
LOCALVERSION=$(svn info "${TOOLSDIRECTORY}"/armitage/ | grep Revision | cut -f 2 -d:)
#Armitage Install Function
armitage_install()
{
		PRINT_GOOD "Downloading ${PACKAGE_NAME}"
		svn co ${SVNLOCATION} ./armitage
		sudo cp -r ./armitage /usr/local/share/armitage
		sudo sh -c "echo java -jar /usr/local/share/armitage/armitage.jar \$\* > /usr/local/share/armitage/armitage"
		sudo ln -s /usr/local/share/armitage/armitage /usr/local/bin/armitage
}
cd "${TOOLSDIRECTORY}"
if [ ! -d ./armitage/ ]; then
	armitage_install
	echo "alias armitage='-E armitage'" >> ~/.bashrc
elif [ "${LOCALVERSION}" -lt "${REMOTEVERSION}" ]; then #If Revision numbers
	PRINT_ERROR "Running old ${PACKAGE_NAME}"
	sudo rm -rf /usr/local/share/armitage/
	armitage_install
	PRINT_GOOD "${PACKAGE_NAME} updated"
else
	PRINT_GOOD "${PACKAGE_NAME} already up-to-date"
fi