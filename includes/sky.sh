#!/bin/bash

# Sky
PACKAGE_NAME="Sky Ubuntu 64 Bit"
PRINT_MESSAGE "Checking for ${PACKAGE_NAME} updates"
REMOTEVERSION=$(curl http://tel.red/linux/ | grep -oP '(?<=> sky_ubuntu64_v).*(?=.deb<)' | tail -n1)
LOCALVERSION=$(dpkg-query -W -f='${Status} ${Version}\n' sky | awk '{print $4}')

sky_install()
{
	PRINT_GOOD "Downloading ${PACKAGE_NAME}"
	dpkg -r sky
	cd /tmp
	rm -rf sky_ubuntu64_v*
	wget "http://tel.red/linux/sky_ubuntu64_v"$REMOTEVERSION".deb"
	sudo dpkg -i "sky_ubuntu64_v"$REMOTEVERSION".deb"
}

# If not installed
if [ -z "$LOCALVERSION" ]; then
	sky_install
	PRINT_GOOD "${PACKAGE_NAME} installed"
elif [ "$REMOTEVERSION" \> "$LOCALVERSION" ]; then
	sky_install
	PRINT_GOOD "${PACKAGE_NAME} updated"
else
	PRINT_GOOD "${PACKAGE_NAME} already up-to-date"
fi